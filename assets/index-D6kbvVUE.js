import{I as W,j as e,g as je,h as se,p as ge}from"./index-DRr5pGCD.js";import{r as j,s as ve,u as be,A as q,T as L,m as Y,v as Ne,I as we,B as re,E as Se,w as K,f as $,C as ae,p as P,q as T,x as le,P as ie,e as A,o as I,y as _,z as Ce}from"./antd-ZHbk-s-w.js";import{E as fe}from"./echarts-Ciy02nJd.js";import"./vendor-Bzgz95E1.js";import"./router-CZaN6CeF.js";function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Z.apply(this,arguments)}const Te=(t,a)=>j.createElement(W,Z({},t,{ref:a,icon:ve})),Me=j.forwardRef(Te);var Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};function Q(){return Q=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Q.apply(this,arguments)}const Fe=(t,a)=>j.createElement(W,Q({},t,{ref:a,icon:Re})),ke=j.forwardRef(Fe);var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M926 164H94c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V196c0-17.7-14.3-32-32-32zm-40 632H134V236h752v560zm-658.9-82.3c3.1 3.1 8.2 3.1 11.3 0l172.5-172.5 114.4 114.5c3.1 3.1 8.2 3.1 11.3 0l297-297.2c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L531 565 416.6 450.5a8.03 8.03 0 00-11.3 0l-214.9 215a8.03 8.03 0 000 11.3l36.7 36.9z"}}]},name:"fund",theme:"outlined"};function X(){return X=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},X.apply(this,arguments)}const Oe=(t,a)=>j.createElement(W,X({},t,{ref:a,icon:Ie})),V=j.forwardRef(Oe);var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};function J(){return J=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},J.apply(this,arguments)}const Ae=(t,a)=>j.createElement(W,J({},t,{ref:a,icon:$e})),F=j.forwardRef(Ae);function ee(){return ee=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},ee.apply(this,arguments)}const Le=(t,a)=>j.createElement(W,ee({},t,{ref:a,icon:be})),De=j.forwardRef(Le);var ze=typeof global=="object"&&global&&global.Object===Object&&global,Ee=typeof self=="object"&&self&&self.Object===Object&&self,ye=ze||Ee||Function("return this")(),U=ye.Symbol,pe=Object.prototype,Pe=pe.hasOwnProperty,Ve=pe.toString,D=U?U.toStringTag:void 0;function We(t){var a=Pe.call(t,D),s=t[D];try{t[D]=void 0;var n=!0}catch{}var l=Ve.call(t);return n&&(a?t[D]=s:delete t[D]),l}var Be=Object.prototype,_e=Be.toString;function Ue(t){return _e.call(t)}var Ke="[object Null]",He="[object Undefined]",ce=U?U.toStringTag:void 0;function Ge(t){return t==null?t===void 0?He:Ke:ce&&ce in Object(t)?We(t):Ue(t)}function qe(t){return t!=null&&typeof t=="object"}var Ye="[object Symbol]";function Ze(t){return typeof t=="symbol"||qe(t)&&Ge(t)==Ye}var Qe=/\s/;function Xe(t){for(var a=t.length;a--&&Qe.test(t.charAt(a)););return a}var Je=/^\s+/;function et(t){return t&&t.slice(0,Xe(t)+1).replace(Je,"")}function te(t){var a=typeof t;return t!=null&&(a=="object"||a=="function")}var oe=NaN,tt=/^[-+]0x[0-9a-f]+$/i,st=/^0b[01]+$/i,at=/^0o[0-7]+$/i,nt=parseInt;function de(t){if(typeof t=="number")return t;if(Ze(t))return oe;if(te(t)){var a=typeof t.valueOf=="function"?t.valueOf():t;t=te(a)?a+"":a}if(typeof t!="string")return t===0?t:+t;t=et(t);var s=st.test(t);return s||at.test(t)?nt(t.slice(2),s?2:8):tt.test(t)?oe:+t}var H=function(){return ye.Date.now()},rt="Expected a function",lt=Math.max,it=Math.min;function ct(t,a,s){var n,l,r,c,i,u,f=0,x=!1,g=!1,d=!0;if(typeof t!="function")throw new TypeError(rt);a=de(a)||0,te(s)&&(x=!!s.leading,g="maxWait"in s,r=g?lt(de(s.maxWait)||0,a):r,d="trailing"in s?!!s.trailing:d);function o(b){var R=n,M=l;return n=l=void 0,f=b,c=t.apply(M,R),c}function C(b){return f=b,i=setTimeout(y,a),x?o(b):c}function p(b){var R=b-u,M=b-f,ne=a-R;return g?it(ne,r-M):ne}function m(b){var R=b-u,M=b-f;return u===void 0||R>=a||R<0||g&&M>=r}function y(){var b=H();if(m(b))return h(b);i=setTimeout(y,p(b))}function h(b){return i=void 0,d&&n?o(b):(n=l=void 0,c)}function N(){i!==void 0&&clearTimeout(i),f=0,n=u=l=i=void 0}function w(){return i===void 0?c:h(H())}function v(){var b=H(),R=m(b);if(n=arguments,l=this,u=b,R){if(i===void 0)return C(u);if(g)return clearTimeout(i),i=setTimeout(y,a),o(u)}return i===void 0&&(i=setTimeout(y,a)),c}return v.cancel=N,v.flush=w,v}const{Text:B}=L,ot=({funds:t,onFundSelect:a,placeholder:s="搜索基金名称或代码",className:n="",size:l="middle"})=>{const[r,c]=j.useState(""),[i,u]=j.useState([]),f=m=>{switch(m){case"mixed":return{label:"混合",color:"blue"};case"stock":return{label:"股票",color:"red"};case"bond":return{label:"债券",color:"green"};case"index":return{label:"指数",color:"orange"};default:return{label:"其他",color:"default"}}},x=m=>{const y=m>=0?"#52c41a":"#ff4d4f",h=m>=0?"+":"";return e.jsxs(B,{style:{color:y,fontSize:"12px"},children:[h,m.toFixed(2),"%"]})},g=j.useCallback(m=>{if(!m.trim()){u([]);return}const y=m.toLowerCase(),N=t.filter(w=>w.name.toLowerCase().includes(y)||w.code.toLowerCase().includes(y)).slice(0,10).map(w=>{const v=f(w.type);return{value:`${w.name} (${w.code})`,fund:w,label:e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(q,{size:"small",icon:e.jsx(V,{}),className:"bg-primary-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"font-medium truncate",children:w.name}),e.jsx(Y,{color:v.color,children:v.label})]}),e.jsx(B,{className:"text-xs text-gray-500",children:w.code})]})]}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsx("div",{className:"text-sm font-medium",children:w.currentValue.toFixed(4)}),x(w.dailyChangePercent)]})]})}});u(N)},[t]),d=j.useMemo(()=>ct(g,300),[g]),o=m=>{c(m),d(m)},C=(m,y)=>{a(y.fund),c(""),u([])},p=()=>{c(""),u([])};return e.jsx(Ne,{className:n,size:l,value:r,options:i,onSearch:o,onSelect:C,onClear:p,placeholder:s,allowClear:!0,showSearch:!0,filterOption:!1,notFoundContent:r?e.jsx("div",{className:"text-center py-4",children:e.jsx(B,{className:"text-gray-500",children:"未找到匹配的基金"})}):null,children:e.jsx(we,{prefix:e.jsx(je,{className:"text-gray-400"})})})},{Title:dt,Text:O}=L,mt=({allFunds:t,selectedFund:a,watchlist:s,onFundSelect:n,onRemoveFromWatchlist:l,className:r=""})=>{const[c,i]=j.useState(!1),u=t.filter(d=>s.includes(d.code)),f=d=>{switch(d){case"mixed":return{label:"混合",color:"blue"};case"stock":return{label:"股票",color:"red"};case"bond":return{label:"债券",color:"green"};case"index":return{label:"指数",color:"orange"};default:return{label:"其他",color:"default"}}},x=(d,o)=>{const C=d>=0?"#52c41a":"#ff4d4f",p=d>=0?"+":"";return e.jsxs("div",{style:{color:C},children:[e.jsxs("div",{className:"text-sm font-medium",children:[p,d.toFixed(4)]}),e.jsxs("div",{className:"text-xs",children:["(",p,o.toFixed(2),"%)"]})]})},g=d=>{n(d),i(!1)};return e.jsxs("div",{className:`${r}`,children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(dt,{level:4,className:"mb-0 text-gray-900 dark:text-gray-100",children:"基金选择"}),e.jsx(O,{className:"text-gray-500 dark:text-gray-400 text-sm",children:"搜索并管理您的关注基金"})]}),e.jsx(re,{type:"primary",size:"middle",icon:e.jsx(De,{}),onClick:()=>i(!c),className:"shadow-sm",children:c?"取消":"添加基金"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[c&&e.jsx("div",{children:e.jsx(ot,{funds:t,onFundSelect:g,placeholder:"搜索基金名称或代码",size:"middle"})}),a&&e.jsxs("div",{children:[e.jsx(O,{className:"text-sm text-gray-500 mb-2 block",children:"当前选择"}),e.jsx("div",{className:"p-3 bg-primary-50 dark:bg-primary-900/20 rounded-lg border border-primary-200 dark:border-primary-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{size:"small",icon:e.jsx(V,{}),className:"bg-primary-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"font-medium",children:a.name}),e.jsx(Y,{color:f(a.type).color,children:f(a.type).label})]}),e.jsx(O,{className:"text-xs text-gray-500",children:a.code})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium",children:a.currentValue.toFixed(4)}),x(a.dailyChange,a.dailyChangePercent)]})]})})]}),e.jsxs("div",{children:[e.jsxs(O,{className:"text-sm text-gray-500 mb-2 block",children:["关注列表 (",u.length,")"]}),u.length===0?e.jsx(Se,{image:e.jsx(V,{style:{fontSize:32,color:"#d9d9d9"}}),description:"暂无关注的基金",className:"py-4"}):e.jsx(K,{size:"small",dataSource:u,renderItem:d=>e.jsx(K.Item,{className:`cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded px-2 ${a?.code===d.code?"bg-primary-50 dark:bg-primary-900/20":""}`,onClick:()=>n(d),actions:[e.jsx($,{title:"移除关注",children:e.jsx(re,{type:"text",size:"small",icon:e.jsx(Me,{}),onClick:o=>{o.stopPropagation(),l(d.code)},className:"text-gray-400 hover:text-red-500"})},"remove")],children:e.jsx(K.Item.Meta,{avatar:e.jsx(q,{size:"small",icon:e.jsx(V,{}),className:"bg-gray-500"}),title:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"text-sm font-medium truncate",children:d.name}),e.jsx(Y,{color:f(d.type).color,children:f(d.type).label})]}),description:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(O,{className:"text-xs text-gray-500",children:d.code}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs",children:d.currentValue.toFixed(4)}),e.jsxs("div",{className:"text-xs",style:{color:d.dailyChange>=0?"#52c41a":"#ff4d4f"},children:[d.dailyChange>=0?"+":"",d.dailyChangePercent.toFixed(2),"%"]})]})]})})})})]})]})})]})},{Title:xt,Text:S}=L,{Option:ht}=I,ut=[{label:"1月",value:"1M"},{label:"3月",value:"3M"},{label:"6月",value:"6M"},{label:"1年",value:"1Y"},{label:"全部",value:"ALL"}],gt=t=>{if(t.length<2)return{totalReturn:0,annualizedReturn:0,volatility:0,sharpeRatio:0,maxDrawdown:0,beta:0,winRate:0,calmarRatio:0};const a=t.map(h=>h.value),s=[];for(let h=1;h<a.length;h++)s.push((a[h]-a[h-1])/a[h-1]);const n=(a[a.length-1]-a[0])/a[0],r=t.length/365,c=Math.pow(1+n,1/r)-1,i=s.reduce((h,N)=>h+N,0)/s.length,u=s.reduce((h,N)=>h+Math.pow(N-i,2),0)/s.length,f=Math.sqrt(u)*Math.sqrt(252),g=(c-.03)/f;let d=0,o=a[0];for(let h=1;h<a.length;h++){a[h]>o&&(o=a[h]);const N=(o-a[h])/o;N>d&&(d=N)}const C=1+(Math.random()-.5)*.5,m=s.filter(h=>h>0).length/s.length,y=d>0?c/d:0;return{totalReturn:n,annualizedReturn:c,volatility:f,sharpeRatio:g,maxDrawdown:d,beta:C,winRate:m,calmarRatio:y}},ft=({fund:t,fundData:a,timeRange:s,onTimeRangeChange:n,className:l=""})=>{const r=j.useMemo(()=>gt(a),[a]),c=(x,g=2)=>`${(x*100).toFixed(g)}%`,i=x=>x>=0?"#52c41a":"#ff4d4f",u=x=>x<.1?{level:"低",color:"#52c41a"}:x<.2?{level:"中",color:"#faad14"}:{level:"高",color:"#ff4d4f"},f=x=>x>1?{rating:"优秀",color:"#52c41a"}:x>.5?{rating:"良好",color:"#faad14"}:x>0?{rating:"一般",color:"#fa8c16"}:{rating:"较差",color:"#ff4d4f"};return e.jsx(ae,{className:`card ${l}`,title:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(xt,{level:4,className:"mb-0",children:"性能指标"}),e.jsxs(A,{children:[e.jsx(S,{className:"text-sm text-gray-500",children:"统计周期:"}),e.jsx(I,{value:s,onChange:n,size:"small",style:{width:80},children:ut.map(x=>e.jsx(ht,{value:x.value,children:x.label},x.value))})]})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-sm text-gray-500 mb-3 block",children:"收益指标"}),e.jsxs(P,{gutter:[16,16],children:[e.jsx(T,{xs:12,sm:8,children:e.jsx(le,{title:"总收益率",value:r.totalReturn,precision:2,valueStyle:{color:i(r.totalReturn)},formatter:x=>c(x),prefix:r.totalReturn>=0?e.jsx(F,{}):e.jsx(F,{})})}),e.jsx(T,{xs:12,sm:8,children:e.jsx(le,{title:"年化收益率",value:r.annualizedReturn,precision:2,valueStyle:{color:i(r.annualizedReturn)},formatter:x=>c(x),prefix:r.annualizedReturn>=0?e.jsx(F,{}):e.jsx(F,{})})}),e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"胜率"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{percent:r.winRate*100,size:"small",strokeColor:"#52c41a",showInfo:!1,className:"flex-1"}),e.jsx(S,{className:"text-sm font-medium",children:c(r.winRate)})]})]})})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm text-gray-500 mb-3 block",children:"风险指标"}),e.jsxs(P,{gutter:[16,16],children:[e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:"text-sm text-gray-500",children:"波动率"}),e.jsx($,{title:"衡量基金净值波动程度，数值越高风险越大",children:e.jsx(F,{className:"text-xs text-gray-400"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"text-lg font-medium",children:c(r.volatility)}),e.jsxs(S,{className:"text-xs px-2 py-1 rounded",style:{backgroundColor:u(r.volatility).color+"20",color:u(r.volatility).color},children:[u(r.volatility).level,"风险"]})]})]})}),e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:"text-sm text-gray-500",children:"最大回撤"}),e.jsx($,{title:"从最高点到最低点的最大跌幅",children:e.jsx(F,{className:"text-xs text-gray-400"})})]}),e.jsxs(S,{className:"text-lg font-medium text-danger-500",children:["-",c(r.maxDrawdown)]})]})}),e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:"text-sm text-gray-500",children:"Beta系数"}),e.jsx($,{title:"衡量基金相对于市场的敏感度，1表示与市场同步",children:e.jsx(F,{className:"text-xs text-gray-400"})})]}),e.jsx(S,{className:"text-lg font-medium",children:r.beta.toFixed(2)})]})})]})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm text-gray-500 mb-3 block",children:"风险调整指标"}),e.jsxs(P,{gutter:[16,16],children:[e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:"text-sm text-gray-500",children:"夏普比率"}),e.jsx($,{title:"衡量每单位风险获得的超额收益，数值越高越好",children:e.jsx(F,{className:"text-xs text-gray-400"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"text-lg font-medium",children:r.sharpeRatio.toFixed(2)}),e.jsx(S,{className:"text-xs px-2 py-1 rounded",style:{backgroundColor:f(r.sharpeRatio).color+"20",color:f(r.sharpeRatio).color},children:f(r.sharpeRatio).rating})]})]})}),e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:"text-sm text-gray-500",children:"卡玛比率"}),e.jsx($,{title:"年化收益率与最大回撤的比值，数值越高越好",children:e.jsx(F,{className:"text-xs text-gray-400"})})]}),e.jsx(S,{className:"text-lg font-medium",children:r.calmarRatio.toFixed(2)})]})}),e.jsx(T,{xs:12,sm:8,children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"综合评分"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{type:"circle",size:60,percent:Math.max(0,Math.min(100,(r.sharpeRatio+1)*40)),strokeColor:{"0%":"#ff4d4f","50%":"#faad14","100%":"#52c41a"},format:x=>`${Math.round(x||0)}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"基于风险调整收益"}),e.jsx("div",{className:"text-xs text-gray-400",children:"综合评估得分"})]})]})]})})]})]})]})})},{Title:yt,Text:z}=L,{Option:pt}=I,jt=[{label:"1月",value:"1M"},{label:"3月",value:"3M"},{label:"6月",value:"6M"},{label:"1年",value:"1Y"},{label:"全部",value:"ALL"}],me=(t,a=20)=>{const s=[];for(let n=0;n<t.length;n++)if(n<a-1)s.push(NaN);else{const l=t.slice(n-a+1,n+1).reduce((r,c)=>r+c.value,0);s.push(l/a)}return s},vt=(t,a=14)=>{const s=[],n=[],l=[];for(let r=1;r<t.length;r++){const c=t[r].value-t[r-1].value;n.push(c>0?c:0),l.push(c<0?-c:0)}for(let r=0;r<t.length;r++)if(r<a)s.push(NaN);else{const c=n.slice(r-a,r).reduce((f,x)=>f+x,0)/a,i=l.slice(r-a,r).reduce((f,x)=>f+x,0)/a,u=c/(i||1);s.push(100-100/(1+u))}return s},bt=t=>{const a=G(t.map(c=>c.value),12),s=G(t.map(c=>c.value),26),n=a.map((c,i)=>c-s[i]),l=G(n,9),r=n.map((c,i)=>c-l[i]);return{macd:n,signal:l,histogram:r}},G=(t,a)=>{const s=[],n=2/(a+1);s[0]=t[0];for(let l=1;l<t.length;l++)s[l]=t[l]*n+s[l-1]*(1-n);return s},Nt=({fund:t,fundData:a,timeRange:s,onTimeRangeChange:n,onIndicatorToggle:l,loading:r=!1,className:c=""})=>{const[i,u]=j.useState({MA:!0,RSI:!0,MACD:!0}),f=(g,d)=>{u(o=>({...o,[g]:d})),l(g,d)},x=j.useMemo(()=>{if(!a.length)return{};const g=a.map(v=>v.date),d=a.map(v=>v.value),o=me(a,20),C=me(a,60),p=vt(a),{macd:m,signal:y,histogram:h}=bt(a),N=[{name:"净值",type:"line",data:d,smooth:!0,symbol:"none",lineStyle:{width:2,color:"#2D6DF6"},yAxisIndex:0}];i.MA&&N.push({name:"MA20",type:"line",data:o,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#FF6B35",type:"dashed"},yAxisIndex:0},{name:"MA60",type:"line",data:C,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#4ECDC4",type:"dashed"},yAxisIndex:0}),i.RSI&&N.push({name:"RSI",type:"line",data:p,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#9B59B6"},yAxisIndex:1}),i.MACD&&N.push({name:"MACD",type:"line",data:m,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#E74C3C"},yAxisIndex:2},{name:"Signal",type:"line",data:y,smooth:!0,symbol:"none",lineStyle:{width:1,color:"#F39C12"},yAxisIndex:2},{name:"Histogram",type:"bar",data:h,itemStyle:{color:v=>v.value>=0?"#27AE60":"#E74C3C",opacity:.6},yAxisIndex:2});const w=[{type:"value",name:"净值",position:"left",axisLabel:{formatter:"{value}"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.3}}}];return i.RSI&&w.push({type:"value",name:"RSI",position:"right",min:0,max:100,axisLabel:{formatter:"{value}"},splitLine:{show:!1},axisLine:{show:!0},offset:0}),i.MACD&&w.push({type:"value",name:"MACD",position:"right",axisLabel:{formatter:"{value}"},splitLine:{show:!1},axisLine:{show:!0},offset:i.RSI?60:0}),{title:{text:`${t.name} 技术分析`,left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:v=>{if(!Array.isArray(v)||v.length===0)return"";let R=`<div><strong>${new Date(g[v[0].dataIndex]).toLocaleDateString("zh-CN")}</strong></div>`;return v.forEach(M=>{isNaN(M.value)||(R+=`<div style="color: ${M.color}">
                ${M.seriesName}: ${typeof M.value=="number"?M.value.toFixed(4):M.value}
              </div>`)}),R}},legend:{data:N.map(v=>v.name),top:30,type:"scroll"},grid:{left:"10%",right:i.RSI&&i.MACD?"15%":i.RSI||i.MACD?"10%":"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",data:g.map(v=>v.toString()),axisLabel:{formatter:v=>new Date(v).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}},yAxis:w,series:N,dataZoom:[{type:"inside",start:70,end:100},{start:70,end:100,height:30,bottom:20}]}},[a,t,i]);return e.jsx(ae,{className:`card ${c}`,title:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(yt,{level:4,className:"mb-0",children:"技术指标分析"}),e.jsxs(A,{children:[e.jsx(z,{className:"text-sm text-gray-500",children:"时间范围:"}),e.jsx(I,{value:s,onChange:n,size:"small",style:{width:80},children:jt.map(g=>e.jsx(pt,{value:g.value,children:g.label},g.value))})]})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{className:"text-sm text-gray-500 mb-2 block",children:"技术指标"}),e.jsxs(P,{gutter:[16,8],children:[e.jsx(T,{children:e.jsxs(A,{children:[e.jsx(_,{size:"small",checked:i.MA,onChange:g=>f("MA",g)}),e.jsx(z,{className:"text-sm",children:"移动平均线 (MA)"})]})}),e.jsx(T,{children:e.jsxs(A,{children:[e.jsx(_,{size:"small",checked:i.RSI,onChange:g=>f("RSI",g)}),e.jsx(z,{className:"text-sm",children:"相对强弱指数 (RSI)"})]})}),e.jsx(T,{children:e.jsxs(A,{children:[e.jsx(_,{size:"small",checked:i.MACD,onChange:g=>f("MACD",g)}),e.jsx(z,{className:"text-sm",children:"MACD"})]})})]})]}),e.jsx(Ce,{className:"my-4"}),e.jsx("div",{style:{height:500},children:e.jsx(fe,{option:x,style:{height:"100%",width:"100%"},showLoading:r,loadingOption:{text:"加载中...",color:"#2D6DF6",textColor:"#666",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0}})})]})})},{Title:wt,Text:E}=L,{Option:k}=I,St=(t,a)=>{const s=[],n=["均线交叉","RSI超买超卖","MACD金叉死叉","布林带突破","成交量异动"];for(let l=20;l<a.length;l+=Math.floor(Math.random()*15)+5){const r=n[Math.floor(Math.random()*n.length)],c=Math.random()>.6?"buy":Math.random()>.3?"sell":"hold",i=.5+Math.random()*.4;s.push({id:`signal_${l}`,fundCode:t.code,fundName:t.name,date:a[l].date,strategyType:r,signalType:c,confidence:i,recommendation:c==="buy"?"建议买入":c==="sell"?"建议卖出":"建议持有",technicalReason:`基于${r}策略，置信度${Math.round(i*100)}%`})}return s.sort((l,r)=>new Date(l.date).getTime()-new Date(r.date).getTime())},Ct=({fund:t,fundData:a,signals:s,onSignalClick:n,className:l=""})=>{const[r,c]=j.useState({strategyTypes:[],signalTypes:[],minConfidence:0,showAll:!0}),i=j.useMemo(()=>s.length>0?s:St(t,a),[s,t,a]),u=j.useMemo(()=>i.filter(o=>!(!r.showAll&&(r.strategyTypes.length>0&&!r.strategyTypes.includes(o.strategyType)||r.signalTypes.length>0&&!r.signalTypes.includes(o.signalType)||o.confidence<r.minConfidence/100))),[i,r]),f=j.useMemo(()=>Array.from(new Set(i.map(o=>o.strategyType))),[i]),x=o=>{switch(o){case"buy":return"#52c41a";case"sell":return"#ff4d4f";default:return"#d9d9d9"}},g=j.useMemo(()=>{if(!a.length)return{};const o=a.map(m=>m.date),C=a.map(m=>m.value),p=u.map(m=>{const y=o.findIndex(h=>new Date(h).toDateString()===new Date(m.date).toDateString());return y===-1?null:{name:m.strategyType,coord:[y,C[y]],value:m.signalType,itemStyle:{color:x(m.signalType)},symbol:m.signalType==="buy"?"triangle":m.signalType==="sell"?"diamond":"circle",symbolSize:12,data:m}}).filter(Boolean);return{title:{text:`${t.name} 交易信号`,left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:m=>{if(!Array.isArray(m))return"";let y="";return m.forEach(h=>{if(h.componentType==="series"&&h.seriesType==="line"){const N=new Date(o[h.dataIndex]).toLocaleDateString("zh-CN");y+=`<div><strong>${N}</strong></div>`,y+=`<div style="color: ${h.color}">净值: ${h.value.toFixed(4)}</div>`}}),y}},legend:{data:["净值","买入信号","卖出信号","持有信号"],top:30},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",data:o.map(m=>m.toString()),axisLabel:{formatter:m=>new Date(m).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}},yAxis:{type:"value",axisLabel:{formatter:"{value}"},splitLine:{lineStyle:{type:"dashed",opacity:.3}}},series:[{name:"净值",type:"line",data:C,smooth:!0,symbol:"none",lineStyle:{width:2,color:"#2D6DF6"},markPoint:{data:p,tooltip:{formatter:m=>{const y=m.data.data;return`
                  <div><strong>${y.strategyType}</strong></div>
                  <div>信号: ${y.recommendation}</div>
                  <div>置信度: ${Math.round(y.confidence*100)}%</div>
                  <div>时间: ${new Date(y.date).toLocaleDateString("zh-CN")}</div>
                  <div>原因: ${y.technicalReason}</div>
                `}}}}],dataZoom:[{type:"inside",start:70,end:100},{start:70,end:100,height:30,bottom:20}]}},[a,t,u]),d=(o,C)=>{c(p=>({...p,[o]:C}))};return e.jsx(ae,{className:`card ${l}`,title:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(wt,{level:4,className:"mb-0",children:"交易信号分析"}),e.jsxs(A,{children:[e.jsx(ke,{}),e.jsxs(E,{className:"text-sm text-gray-500",children:[u.length," / ",i.length," 个信号"]})]})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsxs(P,{gutter:[16,16],children:[e.jsx(T,{xs:24,sm:12,md:6,children:e.jsxs("div",{children:[e.jsx(E,{className:"text-sm text-gray-500 mb-1 block",children:"显示所有信号"}),e.jsx(_,{checked:r.showAll,onChange:o=>d("showAll",o)})]})}),!r.showAll&&e.jsxs(e.Fragment,{children:[e.jsx(T,{xs:24,sm:12,md:6,children:e.jsxs("div",{children:[e.jsx(E,{className:"text-sm text-gray-500 mb-1 block",children:"策略类型"}),e.jsx(I,{mode:"multiple",placeholder:"选择策略",value:r.strategyTypes,onChange:o=>d("strategyTypes",o),style:{width:"100%"},size:"small",children:f.map(o=>e.jsx(k,{value:o,children:o},o))})]})}),e.jsx(T,{xs:24,sm:12,md:6,children:e.jsxs("div",{children:[e.jsx(E,{className:"text-sm text-gray-500 mb-1 block",children:"信号类型"}),e.jsxs(I,{mode:"multiple",placeholder:"选择信号",value:r.signalTypes,onChange:o=>d("signalTypes",o),style:{width:"100%"},size:"small",children:[e.jsx(k,{value:"buy",children:"买入"}),e.jsx(k,{value:"sell",children:"卖出"}),e.jsx(k,{value:"hold",children:"持有"})]})]})}),e.jsx(T,{xs:24,sm:12,md:6,children:e.jsxs("div",{children:[e.jsx(E,{className:"text-sm text-gray-500 mb-1 block",children:"最低置信度"}),e.jsxs(I,{value:r.minConfidence,onChange:o=>d("minConfidence",o),style:{width:"100%"},size:"small",children:[e.jsx(k,{value:0,children:"不限"}),e.jsx(k,{value:50,children:"50%"}),e.jsx(k,{value:60,children:"60%"}),e.jsx(k,{value:70,children:"70%"}),e.jsx(k,{value:80,children:"80%"})]})]})})]})]})}),e.jsx("div",{style:{height:400},children:e.jsx(fe,{option:g,style:{height:"100%",width:"100%"},onEvents:{click:o=>{o.componentType==="markPoint"&&o.data?.data&&n?.(o.data.data)}}})}),e.jsxs("div",{className:"flex items-center justify-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-success-500 rounded-full"}),e.jsx("span",{children:"买入信号"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-danger-500 rounded-full"}),e.jsx("span",{children:"卖出信号"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),e.jsx("span",{children:"持有信号"})]})]})]})})};se()(ge((t,a)=>({funds:[],selectedFunds:[],fundData:{},isLoading:!1,error:null,setFunds:s=>t({funds:s}),addFund:s=>t(n=>({funds:[...n.funds.filter(l=>l.code!==s.code),s]})),removeFund:s=>t(n=>({funds:n.funds.filter(l=>l.code!==s),selectedFunds:n.selectedFunds.filter(l=>l!==s)})),setSelectedFunds:s=>t({selectedFunds:s}),addToWatchlist:s=>t(n=>({selectedFunds:n.selectedFunds.includes(s)?n.selectedFunds:[...n.selectedFunds,s]})),removeFromWatchlist:s=>t(n=>({selectedFunds:n.selectedFunds.filter(l=>l!==s)})),setFundData:(s,n)=>t(l=>({fundData:{...l.fundData,[s]:n}})),setLoading:s=>t({isLoading:s}),setError:s=>t({error:s}),getSelectedFundsData:()=>{const{funds:s,selectedFunds:n}=a();return s.filter(l=>n.includes(l.code))},getFundByCode:s=>{const{funds:n}=a();return n.find(l=>l.code===s)}}),{name:"fundpilot-funds",partialize:t=>({selectedFunds:t.selectedFunds,funds:t.funds})}));const Tt={enabled:!1,channels:[],frequency:"daily",schedule:"0 18 * * *",credentials:{}},xe={theme:"light",watchlist:[],notifications:Tt,apiKeys:{},dataSync:"local"},Mt=se()(ge((t,a)=>({...xe,isLoading:!1,error:null,updateSettings:s=>t(n=>({...n,...s})),updateNotifications:s=>t(n=>({notifications:{...n.notifications,...s}})),addToWatchlist:s=>t(n=>({watchlist:n.watchlist.includes(s)?n.watchlist:[...n.watchlist,s]})),removeFromWatchlist:s=>t(n=>({watchlist:n.watchlist.filter(l=>l!==s)})),setApiKey:(s,n)=>t(l=>({apiKeys:{...l.apiKeys,[s]:n}})),removeApiKey:s=>t(n=>{const{[s]:l,...r}=n.apiKeys;return{apiKeys:r}}),setLoading:s=>t({isLoading:s}),setError:s=>t({error:s}),resetSettings:()=>t({...xe,isLoading:!1,error:null})}),{name:"fundpilot-settings"}));se((t,a)=>({sidebarCollapsed:!1,globalLoading:!1,loadingMessage:"",modals:{},drawers:{},notifications:[],setSidebarCollapsed:s=>t({sidebarCollapsed:s}),setGlobalLoading:(s,n="")=>t({globalLoading:s,loadingMessage:n}),openModal:s=>t(n=>({modals:{...n.modals,[s]:!0}})),closeModal:s=>t(n=>({modals:{...n.modals,[s]:!1}})),openDrawer:s=>t(n=>({drawers:{...n.drawers,[s]:!0}})),closeDrawer:s=>t(n=>({drawers:{...n.drawers,[s]:!1}})),addNotification:s=>{const n=Date.now().toString();t(r=>({notifications:[...r.notifications,{...s,id:n}]}));const l=s.duration||4500;setTimeout(()=>{a().removeNotification(n)},l)},removeNotification:s=>t(n=>({notifications:n.notifications.filter(l=>l.id!==s)})),clearNotifications:()=>t({notifications:[]})}));const{Title:he,Text:ue}=L,Rt=[{code:"001938",name:"易方达消费精选",type:"mixed",currentValue:2.1234,dailyChange:.0123,dailyChangePercent:.58,lastUpdate:new Date},{code:"320007",name:"华夏科技成长",type:"stock",currentValue:1.8765,dailyChange:-.0087,dailyChangePercent:-.46,lastUpdate:new Date},{code:"161725",name:"招商中证白酒",type:"index",currentValue:.9876,dailyChange:.0034,dailyChangePercent:.35,lastUpdate:new Date},{code:"110022",name:"易方达消费行业",type:"stock",currentValue:3.2145,dailyChange:.0234,dailyChangePercent:.73,lastUpdate:new Date},{code:"000001",name:"华夏成长",type:"mixed",currentValue:1.5432,dailyChange:-.0012,dailyChangePercent:-.08,lastUpdate:new Date},{code:"519066",name:"汇添富蓝筹稳健",type:"mixed",currentValue:2.8765,dailyChange:.0156,dailyChangePercent:.54,lastUpdate:new Date}],Ft=(t,a=90)=>{const s=[],n=Math.random()*2+1;for(let l=a;l>=0;l--){const r=new Date;r.setDate(r.getDate()-l);const c=Math.sin(l*.02)*.3,i=(Math.random()-.5)*.1,u=Math.sin(l*.1)*.15,f=n+c+i+u;s.push({date:r,value:Math.max(.1,f),volume:Math.floor(Math.random()*1e6)})}return s},Lt=()=>{const[t,a]=j.useState(null),[s,n]=j.useState("3M"),[l,r]=j.useState([]),{watchlist:c,addToWatchlist:i,removeFromWatchlist:u}=Mt();j.useEffect(()=>{if(t){const p=s==="1M"?30:s==="3M"?90:s==="6M"?180:s==="1Y"?365:s==="ALL"?730:90,m=Ft(t.code,p);r(m)}},[t,s]);const f=p=>{a(p)},x=p=>{i(p)},g=p=>{u(p)},d=p=>{n(p)},o=(p,m)=>{console.log(`Indicator ${p} ${m?"enabled":"disabled"}`)},C=p=>{console.log("Signal clicked:",p)};return e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(he,{level:2,className:"mb-0 text-gray-900 dark:text-gray-100",children:"基金深度分析"}),e.jsx(ue,{className:"text-gray-500 dark:text-gray-400",children:"专业的技术分析工具，助您做出明智的投资决策"})]}),e.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-3xl shadow-lg border border-white/20 dark:border-gray-700/20 overflow-hidden",children:e.jsx(mt,{allFunds:Rt,selectedFund:t,watchlist:c,onFundSelect:f,onAddToWatchlist:x,onRemoveFromWatchlist:g})}),t?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-3xl shadow-lg border border-white/20 dark:border-gray-700/20 overflow-hidden",children:e.jsx(ft,{fund:t,fundData:l,timeRange:s,onTimeRangeChange:d})}),e.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-3xl shadow-lg border border-white/20 dark:border-gray-700/20 overflow-hidden",children:e.jsx(Nt,{fund:t,fundData:l,indicators:[],timeRange:s,onTimeRangeChange:d,onIndicatorToggle:o})}),e.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-3xl shadow-lg border border-white/20 dark:border-gray-700/20 overflow-hidden",children:e.jsx(Ct,{fund:t,fundData:l,signals:[],onSignalClick:C})})]}):e.jsx("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-3xl shadow-lg border border-white/20 dark:border-gray-700/20 flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto shadow-lg",children:e.jsx(V,{className:"text-5xl text-white"})}),e.jsxs("div",{children:[e.jsx(he,{level:3,className:"text-gray-700 dark:text-gray-300 mb-2",children:"选择基金开始分析"}),e.jsx(ue,{className:"text-gray-500 dark:text-gray-400 text-base",children:"从上方搜索或选择一个基金进行深度技术分析"})]})]})})]})};export{Lt as default};
//# sourceMappingURL=index-D6kbvVUE.js.map
